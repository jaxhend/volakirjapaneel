#OK
# Programmi eesmärk on võtta LHV veebilehelt võlakirjade pikemad nimed (lahti kirjutatud) ja leida neile sobiv ISIN kood.
# bonds.csv on sain leheküljelt https://nasdaqbaltic.com/statistics/et/bonds vajutades nuppu "LAE ALLA XLSX"


from bs4 import BeautifulSoup
import requests


url = "https://fp.lhv.ee/baltiturg"
request = requests.get(url)
soup = BeautifulSoup(request.text, "html.parser")

h1_element = soup.find("h1", string="Balti võlakirjade nimekiri")
table = h1_element.find_next("table")
td_elements = table.find_all("td")

d1 = {}
for i in range(10, len(td_elements) - 1, 10):
    name = td_elements[i].get_text()
    symbol = td_elements[i + 1].get_text()
    d1[symbol] = name
# print(d1)

d1 = {
    "ADMB080027A": "Admiral Markets 8% allutatud võlakiri 28.12.2027",
    "ADMG080031A": "Admirals Group 8% allutatud võlakiri 05.02.2031",
    "BIGB065034A": "Bigbank 6.5% allutatud võlakiri 24-2034",
    "BIGB070034A": "Bigbank 7% allutatud võlakiri 29.05.2034",
    "BIGB080032A": "Bigbank 8% allutatud võlakiri 21.09.2032",
    "BIGB080033A": "Bigbank 8% allutatud võlakiri 8% 16.02.2033",
    "BIGB080033B": "Bigbank 8% allutatud võlakiri 30.11.2033",
    "CPAB050032A": "Coop Pank 5% allutatud võlakiri 10.03.2032",
    "CPAB055031A": "Coop Pank 5.5% allutatud võlakiri 31.03.2031",
    "ETGB033026A": "Eesti Vabariigi võlakiri 3.3% 16.09.2026",
    "HLMBK095034FA": "Holm Bank 9.50% võlakiri 30.05.2034",
    "INBB055031A": "Inbank 5.5% allutatud võlakiri 15.12.2031",
    "INBB060029A": "Inbank 6% allutatud võlakiri 19.12.2029",
    "INBB090033A": "Inbank 9.00% allutatud võlakiri 13.12.2033",
    "IUTE110026A": "IuteCredit Finance S.a r.l 11% võlakiri 06.10.2026",
    "LHVB060030A": "LHV Group 6% allutatud võlakiri 30.09.2030",
    "LHVB060034A": "LHV Group 6% allutatud võlakiri 15.11.2034",
    "LHVB105033A": "LHV Group 10.5% allutatud võlakiri 29.09.2033",
    "LVNB105028A": "Liven rohevõlakiri 10.5%",
    "MAYB085027FA": "Mainor Ülemiste 8.5% võlakiri 10.03.2027",
    "MODE110027FA": "Modera võlakiri 11% 13.09.2027",
    "PRFB062525A": "PRFoods 6.25% võlakiri 22.01.2025",
    "TUUL100027FA": "TUUL Mobility 10% võlakiri 29.03.2027",
    "UPPB080022FA": "UPP & CO KAUNO 53 6% võlakiri 17.04.20227.2024",
    "": "Leedu",
    "AMBEFLOT27A": "Amber Beverage Group Holding 4Y",
    "ARSEN120026FA": "Arsenal Industrial bond 12% 31.05.2026",
    "BORA070029A": "BluOr Bank allutatud võlakiri 7% 22-2029 EUR",
    "BORA100034A": "BluOr Bank allutatud võlakiri 10% 02.10.2034",
    "CBLB050031A": "Citadele banka võlakiri EUR 5% 13.12.2031",
    "CBLB080034A": "Citadele Banka 8% bond 05.04.2034",
    "CBLBFLOT26B": "Citadele banka 5% senior unsecured preferred bonds 24-2026",
    "COFAD090025FA": "Coffee Address Holding 9.00% 30/06/2025 EUR",
    "CRGBFLOT25FA": "CleanR Grupa 3Y 6.5%+3M EURIBOR",
    "DGRB100028A": "DelfinGroup 4Y bond 25.09.2028",
    "DGRBFLOT26FA": "DelfinGroup 2.5Y bond 9% + 3M EURIBOR",
    "DGRBFLOT26FB": "DelfinGroup bond 9% + 3M EURIBOR 25.11.2026",
    "DGRBFLOT28FA": "DelfinGroup subordinated 11.50% + 3M EURIBOR 25.07.2028",
    "ECOB080026FA": "Eco Baltia võlakiri 8% 23-2026",
    "ELEV095026A": "Eleving Group 9.50% 18/10/2026",
    "ELEV130028A": "Eleving Group 13% 31/10/2028",
    "FOUR112528FA": "4finance 11.25% 12Y bond 05/23/2028 EUR",
    "GIVENFLOT25FA": "Given Jewellery 3Y bond 6% + 3M EURIBOR",
    "GREG100027A": "Grenardi Group 10% 16.04.2027",
    "GREG100027B": "Grenardi Group 10% 30.08.2027",
    "ICOTNFLOT27FA": "iCotton 3.5Y bond",
    "LNGB100027A": "Longo Group 10.00% 3Y bond",
    "STOH100026A": "Storent Holdings 10% 21.09.2026",
    "STOH110025A": "Storent Holdings 11% 21.12.2025",
    "SUMC095027FA": "Summus Capital 9.50% 3Y bond",
    "SUNBFLOT25FA": "Sun Finance 3Y bond 11.00%+3M EURIBOR",
    "SUNBFLOT26FA": "Sun Finance 3.5Y bond 11.00%+3M EURIBOR",
    "15MIN098026FA": "15min 9.8% 2Y bond",
    "AUGB060024A": "AUGA Group võlakiri 11.12.2024",
    "CPTBFLO26FA": "CAPITALICA Z114 REAL ESTATE FUND 6% + 6M EURIBOR 29/06/2026",
    "FASTL120027FA": "UAB Consilium optimum 12% bond",
    "FERN090026FA": "FERN Group bond 9% 13.09.2026",
    "HEROBFLOT26FA": "Sostinės bokštai 6% + 6M EURIBOR 18/05/2026",
    "INTRFLOT26FA": "Integre Trans 3Y bond 12%+6M EURIBOR",
    "IVLB070027A": "Invalda INVL 7% 14/06/2027",
    "OPMB070025A": "Medicinos bankas 7% 07/24/2025 EUR",
    "SABB077034A": "Siauliu Bankas 7.70% Subordinated 22/05/2034",
    "SIAULIU02062033": "Siauliu Bankas 10.75% 02/06/2033",
}


with open("bonds.csv", "r") as file:
    d2 = {}
    for el in file:
        name, symbol, isin = el.strip().split(";")
        d2[symbol] = (name, isin)
# print(d2)

d2 = {
    "15MIN098026FA": ("15min 9.8% 2Y bond", "LT0000409864"),
    "ACLB070026A": ("AgroCredit Latvia 7% bond", "LV0000802106"),
    "ADMB080027A": ("Admiral Markets 8% subord. bond", "EE3300111251"),
    "ADMG080031A": ("Admirals Group 8.00% subord.bond", "EE3300001999"),
    "AEIB050025A": ("Atsin.energ.investicijos 5% 4Y b", "LT0000405938"),
    "AGAB110026FA": ("Agathum 11% 2Y bond", "LT0000409286"),
    "AKRB0287526A": ("AKROPOLIS GROUP 2.875% 5Y bond", "XS2346869097"),
    "ALTM004426A": ("Altum 0,443% 5Y bond", "LV0000870095"),
    "ALTM013025A": ("Altum 1.3% 7Y bond", "LV0000880037"),
    "AMBEFLOT27A": ("Amber Beverage Group Holding 4Y", "LV0000870137"),
    "ARSEN120026FA": ("Arsenal Industrial 2.5Y bond", "LV0000860153"),
    "ASTB005027A": ("AST 0.5% 5.25Y green bond", "LV0000802528"),
    "BANGA060025FA": ("Banga Ltd 3Y bond", "LV0000860088"),
    "BIGB065034A": ("Bigbank 6.5% subord. bond", "EE3300004977"),
    "BIGB070034A": ("Bigbank 7.00% subord. bond", "EE3300004340"),
    "BIGB080032A": ("Bigbank 8.00% subord.bond", "EE3300002690"),
    "BIGB080033A": ("Bigbank 8.00% subord.bond", "EE3300003052"),
    "BIGB080033B": ("Bigbank 8.00% subord. bond", "EE3300003706"),
    "BORA070029A": ("BluOr Bank 7.00% 7Y bond", "LV0000802569"),
    "BORA100034A": ("BluOr Bank 10% 10Y bond", "LV0000804060"),
    "CAPTFLOT25FA": ("Capitalica 2Y bond", "LT0000408247"),
    "CBLB050031A": ("Citadele banka 5% 10Y bond\xa0", "LV0000880102"),
    "CBLB055027A": ("Citadele banka 5.5% 10Y bond\xa0", "LV0000880011"),
    "CBLB080034A": ("Citadele Banka 8% 10Y bond", "LV0000803054"),
    "CBLBFLOT26A": ("Citadele 5Y bond", "XS2393742122"),
    "CBLBFLOT26B": ("Citadele banka 2Y bond", "LV0000804334"),
    "CCLAT080027FA": ("CrossChem 8.00% 3Y bond", "LV0000804698"),
    "CIVB110025FA": ("Civinity 11% 2Y bond", "LT0000408197"),
    "COFAD090025FA": ("Coffee Address Holding 9.00% 3Y", "LV0000802585"),
    "CPAB050032A": ("Coop Pank 5% bond", "EE3300002542"),
    "CPAB055031A": ("Coop Pank 5.5% bond", "EE3300002047"),
    "CPTBFLO26FA": ("Capitalica 2Y bond", "LT0000408551"),
    "CRGBFLOT25FA": ("CleanR Grupa 3Y bond", "LV0000802676"),
    "DGRB100028A": ("DelfinGroup 10% 4Y bond", "LV0000803914"),
    "DGRBFLOT26FA": ("DelfinGroup 2.5Y bonds", "LV0000802718"),
    "DGRBFLOT26FB": ("DelfinGroup 3Y bond", "LV0000860146"),
    "DGRBFLOT28FA": ("DelfinGroup 5Y bond", "LV0000802700"),
    "ECOB080026FA": ("Eco Baltia 8.00% 3Y bond", "LV0000860120"),
    "ECOB090026FA": ("Eco Baltia 9.00% 3Y bond", "LV0000860138"),
    "ELEK005028A": ("Latvenergo 0.5% 7Y green bond", "LV0000802460"),
    "ELEK024227A": ("Latvenergo 2.42% 5Y green bond", "LV0000870129"),
    "ELEK0495229A": ("Latvenergo 4.952% 6Y green bond", "LV0000802684"),
    "ELEV095026A": ("Eleving Group 9.50% 5Y bond", "XS2393240887"),
    "ELEV130028A": ("Eleving Group 5Y bond", "DE000A3LL7M4"),
    "ELGB060026FA": ("Elko Grupa 6% 5Y bond", "LV0000870079"),
    "EPSO0311727A": ("EPSO-G 3.117% 5Y bond", "LT0000406530"),
    "ETGB033026A": ("Estonian Gov. 2Y bond", "EE1300001563"),
    "FASTL120027FA": ("Consilium optimum 12% 3Y bond", "LT0000409047"),
    "FERN090026FA": ("FERN Group 9% 2Y bond", "LT0000409633"),
    "FOUR112528FA": ("4finance 11.25% 12Y bond", "XS1417876163"),
    "GIVENFLOT25FA": ("GIVEN Jewellery 3Y bond", "LV0000860104"),
    "GREG100027A": ("Grenardi Group 10% 3Y bond", "LV0000860179"),
    "GREG100027B": ("Grenardi Group 10% 3Y bond", "LV0000860195"),
    "HEROBFLOT26FA": ("Sostines bokstai 3Y bond", "LT0000407629"),
    "HEST045027FA": ("Hestio 4.5% 5Y bond", "LV0000802650"),
    "HLMBK095034FA": ("Holm Bank 9.50% subord. bond", "EE3300004290"),
    "ICOTNFLOT27FA": ("iCotton 3.5Y bond", "LV0000802783"),
    "IGNB0187528A": ("Ignitis grupe 1.875% 10Y green", "XS1853999313"),
    "IGNB020027A": ("Ignitis grupe 2% 10Y green bond", "XS1646530565"),
    "IGNB020030A": ("Ignitis grupe 2% 10Y bond", "XS2177349912"),
    "INBB055031A": ("Inbank 5.5% subord. bond", "EE3300002302"),
    "INBB060029A": ("Inbank 6.00% subord. bond", "EE3300001544"),
    "INBB090033A": ("Inbank 9.00% subord. bond", "EE3300003714"),
    "IUTE110026A": ("IuteCredit Finance 5Y bond", "XS2378483494"),
    "IVLB070027A": ("Invalda INVL 7% 3Y bond", "LT0000409229"),
    "LEBA080025FA": ("Legal Balance 3Y 8% bond", "LT0000407066"),
    "LEBAFLOAT27FA": ("Legal Balance 3Y bond", "LT0000409005"),
    "LHVB060030A": ("LHV Group 10Y 6.00% sub. bond", "EE3300001791"),
    "LHVB060034A": ("LHV Group 6.00% subord. bond", "EE3300004993"),
    "LHVB105033A": ("LHV Group 10.5% subord. bond", "EE3300003573"),
    "LNGB100027A": ("Longo Group 10.00% 3Y bond", "LV0000804987"),
    "LONGOFLOT25FA": ("Longo Group 3Y Bond", "LV0000860096"),
    "LTGB000026B": ("Lithuanian Gov. 5Y Bond 65006", "LT0000650061"),
    "LTGB000026C": ("Lithuanian Gov. 5Y Bond 65007", "LT0000650079"),
    "LTGB000028B": ("Lithuanian Gov. 7Y Bond 67005", "LT0000670051"),
    "LTGB001026A": ("Lithuanian Gov. 7Y Bond 67004", "LT0000670044"),
    "LTGB002029A": ("Lithuanian Gov. 10Y Bond 61008", "LT0000610081"),
    "LTGB003032A": ("Lithuanian Gov. 12Y Bond 61201", "LT0000612012"),
    "LTGB008025A": ("Lithuanian Gov. 7Y Bond 67003", "LT0000670036"),
    "LTGB011027A": ("Lithuanian Gov. 10Y Bond 61007", "LT0000610073"),
    "LTGB013025B": ("Lithuanian Gov. 3Y Bond 63009", "LT0000630097"),
    "LTGB023027B": ("Lithuanian Gov. 5Y Bond 65008", "LT0000650087"),
    "LTGB024029B": ("Lithuanian Gov. 7Y Bond 67006", "LT0000670069"),
    "LTGB039026D": ("Lithuanian Gov. 3Y Bond 63010", "LT0000630105"),
    "LTGGB012028A": ("Lith. Gov. 10Y Green Bond 61030", "LT0000610305"),
    "LVGB000025A": ("Latv Gov. 5.5-year T-bond 57017", "LV0000570174"),
    "LVGB000027A": ("Latv Gov.  7-year T-bond 57018", "LV0000570182"),
    "LVNB105028A": ("Liven 10.5% 4Y green bond", "EE3300004332"),
    "MARI100025FA": ("Marijas 2 1Y bonds", "LV0000803179"),
    "MAYB047526FA": ("Mainor Ulemiste 4.75% 5Y bond", "EE3300002138"),
    "MAYB085027FA": ("Mainor Ülemiste 8.5% bond", "EE3300003136"),
    "MDGBFLOT25FA": ("Modus Grupe 2Y bond", "LT0000408445"),
    "MODE110027FA": ("Modera 11% bond", "EE3300004860"),
    "MXGR062527A": ("Maxima grupe 6.25% 5Y bond", "XS2485155464"),
    "NHCBFLO28A": ("Baltic Horizon Fund 5Y bond", "EE3300003235"),
    "OPMB070025A": ("Medicinos bankas 7% 7Y subord.b.", "LT0000432114"),
    "ORKL060025A": ("Orkela 6% 3Y bond", "LT0000405961"),
    "PKGB080024A": ("Pro Kapital Grupp 9.00% bond", "EE3300001676"),
    "PP4B090026A": ("Partner. proj. keturi 9% 3Y bond", "LT0000407561"),
    "PRFB062525A": ("PRFoods 6.25% bond", "EE3300001577"),
    "REFIE095025FA": ("REFI Energy 2Y bond", "LT0000407769"),
    "RTOB120029FA": ("RATO kredito unija 7Y 12% bond", "LT0000407603"),
    "SABB061529A": ("Siauliu bankas 6,15% bond", "LT0000404287"),
    "SABB077034A": ("Siauliu bankas 7,7% 10Y bond", "LT0000409013"),
    "SABB107533A": ("Siauliu bankas 10,75% bond", "LT0000407751"),
    "SIGR115026FA": ("Sun Investment Group 2Y bond", "LT0000409963"),
    "STOH100026A": ("Storent Holding 10% 2.5Y bond", "LV0000850345"),
    "STOH110025A": ("Storent Holdings 11% 2.5Y bond", "LV0000850089"),
    "SUMC095027FA": ("Summus Capital 9,50% 3Y bond", "LV0000860187"),
    "SUNBFLOT25FA": ("Sun Finance 3Y bond", "LV0000860112"),
    "SUNBFLOT26FA": ("Sun Finance 3.5Y bond", "LV0000802692"),
    "TUUL100027FA": ("Tuul Mobility 10% bond", "EE3300002559"),
    "UPOB060025FA": ("UPP Olaines 6% bond", "EE3300002567"),
    "UPPB080022FA": ("UPP & CO Kauno 53 7.00% bond", "EE3300111152"),
    "VIKA000025A": ("Valst. inv. kap. 0.00% 4 Y bond", "LT0000405664"),
    "VIKA006525B": ("Valst. inv. kap. 0.65% 3Y bond", "LT0000406258"),
    "VIKA0282627A": ("Valst. inv. kap. 2.826% 5Y bond", "LT0000406613"),
}


result = {}
for symbol1, lhv_name in d1.items():
    for symbol2, name_and_isin in d2.items():
        if symbol1 == symbol2:
            result[lhv_name] = name_and_isin[1]
# print(result)

database = {
    "Admiral Markets 8% allutatud võlakiri 28.12.2027": "EE3300111251",
    "Admirals Group 8% allutatud võlakiri 05.02.2031": "EE3300001999",
    "Bigbank 6.5% allutatud võlakiri 24-2034": "EE3300004977",
    "Bigbank 7% allutatud võlakiri 29.05.2034": "EE3300004340",
    "Bigbank 8% allutatud võlakiri 21.09.2032": "EE3300002690",
    "Bigbank 8% allutatud võlakiri 8% 16.02.2033": "EE3300003052",
    "Bigbank 8% allutatud võlakiri 30.11.2033": "EE3300003706",
    "Coop Pank 5% allutatud võlakiri 10.03.2032": "EE3300002542",
    "Coop Pank 5.5% allutatud võlakiri 31.03.2031": "EE3300002047",
    "Eesti Vabariigi võlakiri 3.3% 16.09.2026": "EE1300001563",
    "Holm Bank 9.50% võlakiri 30.05.2034": "EE3300004290",
    "Inbank 5.5% allutatud võlakiri 15.12.2031": "EE3300002302",
    "Inbank 6% allutatud võlakiri 19.12.2029": "EE3300001544",
    "Inbank 9.00% allutatud võlakiri 13.12.2033": "EE3300003714",
    "IuteCredit Finance S.a r.l 11% võlakiri 06.10.2026": "XS2378483494",
    "LHV Group 6% allutatud võlakiri 30.09.2030": "EE3300001791",
    "LHV Group 6% allutatud võlakiri 15.11.2034": "EE3300004993",
    "LHV Group 10.5% allutatud võlakiri 29.09.2033": "EE3300003573",
    "Liven rohevõlakiri 10.5%": "EE3300004332",
    "Mainor Ülemiste 8.5% võlakiri 10.03.2027": "EE3300003136",
    "Modera võlakiri 11% 13.09.2027": "EE3300004860",
    "PRFoods 6.25% võlakiri 22.01.2025": "EE3300001577",
    "TUUL Mobility 10% võlakiri 29.03.2027": "EE3300002559",
    "UPP & CO KAUNO 53 6% võlakiri 17.04.20227.2024": "EE3300111152",
    "Amber Beverage Group Holding 4Y": "LV0000870137",
    "Arsenal Industrial bond 12% 31.05.2026": "LV0000860153",
    "BluOr Bank allutatud võlakiri 7% 22-2029 EUR": "LV0000802569",
    "BluOr Bank allutatud võlakiri 10% 02.10.2034": "LV0000804060",
    "Citadele banka võlakiri EUR 5% 13.12.2031": "LV0000880102",
    "Citadele Banka 8% bond 05.04.2034": "LV0000803054",
    "Citadele banka 5% senior unsecured preferred bonds 24-2026": "LV0000804334",
    "Coffee Address Holding 9.00% 30/06/2025 EUR": "LV0000802585",
    "CleanR Grupa 3Y 6.5%+3M EURIBOR": "LV0000802676",
    "DelfinGroup 4Y bond 25.09.2028": "LV0000803914",
    "DelfinGroup 2.5Y bond 9% + 3M EURIBOR": "LV0000802718",
    "DelfinGroup bond 9% + 3M EURIBOR 25.11.2026": "LV0000860146",
    "DelfinGroup subordinated 11.50% + 3M EURIBOR 25.07.2028": "LV0000802700",
    "Eco Baltia võlakiri 8% 23-2026": "LV0000860120",
    "Eleving Group 9.50% 18/10/2026": "XS2393240887",
    "Eleving Group 13% 31/10/2028": "DE000A3LL7M4",
    "4finance 11.25% 12Y bond 05/23/2028 EUR": "XS1417876163",
    "Given Jewellery 3Y bond 6% + 3M EURIBOR": "LV0000860104",
    "Grenardi Group 10% 16.04.2027": "LV0000860179",
    "Grenardi Group 10% 30.08.2027": "LV0000860195",
    "iCotton 3.5Y bond": "LV0000802783",
    "Longo Group 10.00% 3Y bond": "LV0000804987",
    "Storent Holdings 10% 21.09.2026": "LV0000850345",
    "Storent Holdings 11% 21.12.2025": "LV0000850089",
    "Summus Capital 9.50% 3Y bond": "LV0000860187",
    "Sun Finance 3Y bond 11.00%+3M EURIBOR": "LV0000860112",
    "Sun Finance 3.5Y bond 11.00%+3M EURIBOR": "LV0000802692",
    "15min 9.8% 2Y bond": "LT0000409864",
    "CAPITALICA Z114 REAL ESTATE FUND 6% + 6M EURIBOR 29/06/2026": "LT0000408551",
    "UAB Consilium optimum 12% bond": "LT0000409047",
    "FERN Group bond 9% 13.09.2026": "LT0000409633",
    "Sostinės bokštai 6% + 6M EURIBOR 18/05/2026": "LT0000407629",
    "Invalda INVL 7% 14/06/2027": "LT0000409229",
    "Medicinos bankas 7% 07/24/2025 EUR": "LT0000432114",
    "Siauliu Bankas 7.70% Subordinated 22/05/2034": "LT0000409013",
}
